00001A20 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 1/7/2021 12:16:53 PM

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : EXAMPLE GAME (MAIN PROGRAM)
00000000                             3  ; AUTHOR   : ANTONI BURGUERA
00000000                             4  ; HISTORY  : 10-OCT-2020 - CREATION
00000000                             5  ;            11-OCT-2020 - MINOR CHANGES
00000000                             6  ; =============================================================================
00000000                             7              OPT     MEX
00001000                             8              ORG     $1000
00001000                             9  
00001000                            10  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            11  
00001000                            12              INCLUDE "SYSCONST.X68"          ; SYSTEM CONSTANTS
00001000                            13  ; =============================================================================
00001000                            14  ; TITLE    : SYSTEM CONSTANTS
00001000                            15  ; AUTHOR   : ANTONI BURGUERA
00001000                            16  ; HISTORY  : XX-XXX-201X - CREATION
00001000                            17  ;            11-OCT-2020 - MINOR CHANGES
00001000                            18  ; =============================================================================
00001000                            19  
00001000                            20  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            21  
00001000  =00000000                 22  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 23  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            24  
00001000                            25  ; --- KEY CODES (EASy68K)
00001000                            26  
00001000  =00000020                 27  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 28  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 29  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 30  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 31  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 32  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 33  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 34  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            35  
00001000                            36  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            37  
00001000  =00000025                 38  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 39  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 40  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 41  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 42  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 43  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 44  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 45  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            46  
00001000                            47  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            48  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            49  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            50  ; +---+---+---+---+---+---+---+---+
00001000                            51  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            52  ; +---+---+---+---+---+---+---+---+
00001000                            53  ;   |   |   |   |   |   |   |   |
00001000                            54  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            55  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            56  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            57  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            58  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            59  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            60  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            61  ;   +-------------------------------------- PAUSE BUTTON
00001000                            62  
00001000  =00000001                 63  KBDMSKLF    EQU     %00000001
00001000  =00000002                 64  KBDMSKUP    EQU     %00000010
00001000  =00000004                 65  KBDMSKRT    EQU     %00000100
00001000  =00000008                 66  KBDMSKDN    EQU     %00001000
00001000  =00000010                 67  KBDMSKF1    EQU     %00010000
00001000  =00000020                 68  KBDMSKF2    EQU     %00100000
00001000  =00000040                 69  KBDMSKF3    EQU     %01000000
00001000  =00000080                 70  KBDMSKPS    EQU     %10000000
00001000                            71  
00001000                            72  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            73  
00001000  =00000000                 74  KBDBITLF    EQU     0
00001000  =00000001                 75  KBDBITUP    EQU     1
00001000  =00000002                 76  KBDBITRT    EQU     2
00001000  =00000003                 77  KBDBITDN    EQU     3
00001000  =00000004                 78  KBDBITF1    EQU     4
00001000  =00000005                 79  KBDBITF2    EQU     5
00001000  =00000006                 80  KBDBITF3    EQU     6
00001000  =00000007                 81  KBDBITPS    EQU     7
00001000                            82  
00001000                            83  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            84  
00001000  =00000280                 85  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 86  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 87  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000064                 88  SCRTIM      EQU     100                       ; SCREEN TIMER (MS)
00001000                            89  
00001000                            90  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            91  
00001000  =00000040                 92  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 93  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 94  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000  =00000000                 95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"            ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; TITLE    : SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; AUTHOR   : ANTONI BURGUERA
00001000                           100  ; COMMENTS : IT IS DIVIDED IN THREE BLOCKS:
00001000                           101  ;            - SYS : GENERIC.
00001000                           102  ;            - SCR : SCREEN MANAGEMENT.
00001000                           103  ;            - KBD : KEYBOARD MANAGEMENT.
00001000                           104  ; HISTORY  : XX-XXX-201X - CREATION
00001000                           105  ;            11-OCT-2020 - MINOR CHANGES
00001000                           106  ; =============================================================================
00001000                           107  
00001000                           108  ; -----------------------------------------------------------------------------
00001000                           109  SYSINIT
00001000                           110  ; INITIALIZES THE SYSTEM
00001000                           111  ; INPUT    - NONE
00001000                           112  ; OUTPUT   - NONE
00001000                           113  ; MODIFIES - NONE
00001000                           114  ; -----------------------------------------------------------------------------
00001000  205F                     115              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 000010B4            116              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            117              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 00001114            118              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                119              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     120              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     121              RTS
0000101C                           122  
0000101C                           123  ; =============================================================================
0000101C                           124  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           125  ; =============================================================================
0000101C                           126  
0000101C                           127  ; -----------------------------------------------------------------------------
0000101C                           128  SCRINIT
0000101C                           129  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           130  ; INPUT    - NONE
0000101C                           131  ; OUTPUT   - NONE
0000101C                           132  ; MODIFIES - D0,D1,D2,D3
0000101C                           133  ; -----------------------------------------------------------------------------
0000101C  007C 0700                134              ORI.W   #$0700,SR               ; DISABLE ALL INT
00001020  21FC 0000109A 0084       135              MOVE.L  #SCRUPD,($80+SCRTRAP*4) ; INSTALL TRAP
00001028  223C 028001E0            136              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1 ; SET RESOLUTION
0000102E  103C 0021                137              MOVE.B  #33,D0
00001032  4E4F                     138              TRAP    #15
00001034  7201                     139              MOVE.L  #1,D1                   ; SET WINDOWED MODE
00001036  4E4F                     140              TRAP    #15
00001038  323C FF00                141              MOVE.W  #$FF00,D1               ; CLEAR VISIBLE BUFFER
0000103C  103C 000B                142              MOVE.B  #11,D0
00001040  4E4F                     143              TRAP    #15
00001042  123C 0011                144              MOVE.B  #17,D1                  ; ENABLE DOUBLE BUFFER
00001046  103C 005C                145              MOVE.B  #92,D0
0000104A  4E4F                     146              TRAP    #15
0000104C  323C FF00                147              MOVE.W  #$FF00,D1               ; CLEAR HIDDEN BUFFER
00001050  103C 000B                148              MOVE.B  #11,D0
00001054  4E4F                     149              TRAP    #15
00001056  21FC 0000108C 0064       150              MOVE.L  #SCRISR,($60+SCRIRQ*4)  ; SET EXCEPTION VECTOR
0000105E  123C 0005                151              MOVE.B  #5,D1                   ; ENABLE EXCEPTION PROCESSING
00001062  103C 0020                152              MOVE.B  #32,D0
00001066  4E4F                     153              TRAP    #15
00001068  143C 0081                154              MOVE.B  #%10000000|SCRIRQ,D2    ; ENABLE AUTO-IRQ
0000106C  163C 0064                155              MOVE.B  #SCRTIM,D3
00001070  123C 0006                156              MOVE.B  #6,D1
00001074  103C 0020                157              MOVE.B  #32,D0
00001078  4E4F                     158              TRAP    #15
0000107A  4239 00001A4A            159              CLR.B   (SCRINTCT)              ; PREPARE INTERRUPT FLAG
00001080  4239 00001A4B            160              CLR.B   (SCRCYCCT)              ; PREPARE CYCLE COUNTER
00001086  027C F8FF                161              ANDI.W  #$F8FF,SR               ; ENABLE INTS
0000108A  4E75                     162              RTS
0000108C                           163  
0000108C                           164  ; -----------------------------------------------------------------------------
0000108C                           165  SCRISR
0000108C                           166  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
0000108C                           167  ; INPUT    - NONE
0000108C                           168  ; OUTPUT   - NONE
0000108C                           169  ; MODIFIES - NONE
0000108C                           170  ; -----------------------------------------------------------------------------
0000108C  5239 00001A4A            171              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
00001092  5239 00001A4B            172              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001098  4E73                     173              RTE
0000109A                           174  
0000109A                           175  ; -----------------------------------------------------------------------------
0000109A                           176  SCRUPD
0000109A                           177  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
0000109A                           178  ; BUFFER FOR THE NEXT ONE.
0000109A                           179  ; INPUT    - NONE
0000109A                           180  ; OUTPUT   - NONE
0000109A                           181  ; MODIFIES - NONE
0000109A                           182  ; -----------------------------------------------------------------------------
0000109A  48A7 C000                183              MOVEM.W D0-D1,-(A7)
0000109E  103C 005E                184              MOVE.B  #94,D0                  ; UPDATE DOUBLE BUFFER
000010A2  4E4F                     185              TRAP    #15
000010A4  323C FF00                186              MOVE.W  #$FF00,D1               ; CLEAR HIDDEN BUFFER
000010A8  103C 000B                187              MOVE.B  #11,D0
000010AC  4E4F                     188              TRAP    #15
000010AE  4C9F 0003                189              MOVEM.W (A7)+,D0-D1
000010B2  4E73                     190              RTE
000010B4                           191  
000010B4                           192  ; =============================================================================
000010B4                           193  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
000010B4                           194  ; =============================================================================
000010B4                           195  
000010B4                           196  ; -----------------------------------------------------------------------------
000010B4                           197  KBDINIT
000010B4                           198  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
000010B4                           199  ; INPUT    - NONE
000010B4                           200  ; OUTPUT   - NONE
000010B4                           201  ; MODIFIES - NONE
000010B4                           202  ; -----------------------------------------------------------------------------
000010B4  4239 00001A48            203              CLR.B   (KBDVAL)                ; INIT VARS
000010BA  4239 00001A49            204              CLR.B   (KBDEDGE)
000010C0  21FC 000010CA 0080       205              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010C8  4E75                     206              RTS
000010CA                           207  
000010CA                           208  ; -----------------------------------------------------------------------------
000010CA                           209  KBDREAD
000010CA                           210  ; TRAP SERVICE ROUTINE.
000010CA                           211  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010CA                           212  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010CA                           213  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010CA                           214  ; INPUT    - NONE
000010CA                           215  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010CA                           216  ; MODIFIES - NONE
000010CA                           217  ; -----------------------------------------------------------------------------
000010CA  48E7 F000                218              MOVEM.L D0-D3,-(A7)
000010CE  103C 0013                219              MOVE.B  #19,D0
000010D2  223C 50104D20            220              MOVE.L  #KBDPAUSE<<24+KBDFIRE3<<16+KBDFIRE2<<8+KBDFIRE1,D1
000010D8  4E4F                     221              TRAP    #15
000010DA  6100 002A                222              BSR     .STORE                  ; STORE FIRE1,FIRE2,FIRE3 AND PAUSE
000010DE  223C 28272625            223              MOVE.L  #KBDDOWN<<24+KBDRIGHT<<16+KBDUP<<8+KBDLEFT,D1
000010E4  4E4F                     224              TRAP    #15
000010E6  6100 001E                225              BSR     .STORE                  ; STORE KEY UP,DOWN,LEFT AND RIGTH.
000010EA  1039 00001A48            226              MOVE.B  (KBDVAL),D0             ; COMPUTE EDGE.
000010F0  4600                     227              NOT.B   D0                      ; EDGE=NOT(PREVIOUS) AND CURRENT.
000010F2  C002                     228              AND.B   D2,D0
000010F4  13C2 00001A48            229              MOVE.B  D2,(KBDVAL)             ; STORE VALUES (PRESS AND EDGE)
000010FA  13C0 00001A49            230              MOVE.B  D0,(KBDEDGE)
00001100  4CDF 000F                231              MOVEM.L (A7)+,D0-D3
00001104  4E73                     232              RTE
00001106                           233  
00001106  363C 0003                234  .STORE      MOVE.W  #3,D3                   ; TRANSLATES THE 8-BIT ENCODING
0000110A  E189                     235  .LOOP       LSL.L   #8,D1                   ; OF TRAP #15 TASK 19 INTO A 1-BIT
0000110C  E312                     236              ROXL.B  #1,D2                   ; PER KEYPRESS ENCODING
0000110E  51CB FFFA                237              DBRA.W  D3,.LOOP
00001112  4E75                     238              RTS
00001114                           239  
00001114                           240  ; =============================================================================
00001114                           241  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001114                           242  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001114                           243  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001114                           244  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001114                           245  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001114                           246  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001114                           247  ; =============================================================================
00001114                           248  
00001114                           249  ; -----------------------------------------------------------------------------
00001114                           250  DMMINIT
00001114                           251  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001114                           252  ; INPUT    - NONE
00001114                           253  ; OUTPUT   - NONE
00001114                           254  ; MODIFIES - NONE
00001114                           255  ; -----------------------------------------------------------------------------
00001114  48E7 8080                256              MOVEM.L D0/A0,-(A7)
00001118  41F9 00001A80            257              LEA     DMMDATA,A0
0000111E  303C 0031                258              MOVE.W  #DMMBNUM-1,D0
00001122  30BC 0000                259  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001126  D1FC 00000040            260              ADD.L   #DMMBSIZE,A0
0000112C  51C8 FFF4                261              DBRA.W  D0,.LOOP
00001130  4CDF 0101                262              MOVEM.L (A7)+,D0/A0
00001134  4E75                     263              RTS
00001136                           264  
00001136                           265  ; -----------------------------------------------------------------------------
00001136                           266  DMMFIRST
00001136                           267  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001136                           268  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001136                           269  ; INPUT    - NONE
00001136                           270  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001136                           271  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001136                           272  ; -----------------------------------------------------------------------------
00001136  41F9 00001A80            273              LEA     DMMDATA,A0
0000113C  4A58                     274  DMMFRLOP    TST.W   (A0)+
0000113E  6600 0016                275              BNE     DMMFRFND
00001142  D1FC 0000003E            276              ADD.L   #DMMBSIZE-2,A0
00001148  B1FC 000026FF            277  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000114E  6DEC                     278              BLT     DMMFRLOP
00001150  207C 00000000            279              MOVE.L  #0,A0
00001156  4E75                     280  DMMFRFND    RTS
00001158                           281  
00001158                           282  ; -----------------------------------------------------------------------------
00001158                           283  DMMNEXT
00001158                           284  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001158                           285  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           286  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001158                           287  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           288  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           289  ; -----------------------------------------------------------------------------
00001158  2F00                     290              MOVE.L  D0,-(A7)
0000115A  2008                     291              MOVE.L  A0,D0
0000115C  C0BC FFFFFFC0            292              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001162  0680 00000040            293              ADD.L   #DMMBSIZE,D0
00001168  2040                     294              MOVE.L  D0,A0
0000116A  201F                     295              MOVE.L  (A7)+,D0
0000116C  60DA                     296              BRA     DMMFRCOM
0000116E                           297  
0000116E                           298  ; -----------------------------------------------------------------------------
0000116E                           299  DMMFRSTO
0000116E                           300  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000116E                           301  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000116E                           302  ; INPUT    - D0.W : ID TO SEARCH
0000116E                           303  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000116E                           304  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000116E                           305  ; -----------------------------------------------------------------------------
0000116E  41F9 00001A80            306              LEA     DMMDATA,A0
00001174  B058                     307  DMMFLOOP    CMP.W   (A0)+,D0
00001176  6700 0016                308              BEQ     DMMFFND
0000117A  D1FC 0000003E            309              ADD.L   #DMMBSIZE-2,A0
00001180  B1FC 000026FF            310  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001186  6DEC                     311              BLT     DMMFLOOP
00001188  207C 00000000            312              MOVE.L  #0,A0
0000118E  4E75                     313  DMMFFND     RTS
00001190                           314  
00001190                           315  ; -----------------------------------------------------------------------------
00001190                           316  DMMNEXTO
00001190                           317  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001190                           318  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001190                           319  ; INPUT    - D0.W : ID TO SEARCH
00001190                           320  ;            A0   : POINTER WITHIN THE CURRENT SLOT
00001190                           321  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001190                           322  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           323  ; -----------------------------------------------------------------------------
00001190  2F00                     324              MOVE.L  D0,-(A7)
00001192  2008                     325              MOVE.L  A0,D0
00001194  C0BC FFFFFFC0            326              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000119A  0680 00000040            327              ADD.L   #DMMBSIZE,D0
000011A0  2040                     328              MOVE.L  D0,A0
000011A2  201F                     329              MOVE.L  (A7)+,D0
000011A4  60DA                     330              BRA     DMMFCOM
000011A6                           331  
000011A6                           332  ; -----------------------------------------------------------------------------
000011A6                           333  DMMALLOC
000011A6                           334  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
000011A6                           335  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
000011A6                           336  ; INPUT    - D0.W : ID TO ASSIGN
000011A6                           337  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
000011A6                           338  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000011A6                           339  ; -----------------------------------------------------------------------------
000011A6  3F00                     340              MOVE.W  D0,-(A7)
000011A8  4240                     341              CLR.W   D0
000011AA  4EB8 116E                342              JSR     DMMFRSTO
000011AE  301F                     343              MOVE.W  (A7)+,D0
000011B0  B1FC 00000000            344              CMP.L   #0,A0
000011B6  6700 0006                345              BEQ     .END
000011BA  3140 FFFE                346              MOVE.W  D0,-2(A0)
000011BE  4E75                     347  .END        RTS
000011C0                           348  
000011C0                           349  ; -----------------------------------------------------------------------------
000011C0                           350  DMMFREE
000011C0                           351  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011C0                           352  ; SYSTEM (0)
000011C0                           353  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011C0                           354  ; OUTPUT   - NONE
000011C0                           355  ; MODIFIES - NONE
000011C0                           356  ; -----------------------------------------------------------------------------
000011C0  48E7 8080                357              MOVEM.L D0/A0,-(A7)
000011C4  2008                     358              MOVE.L  A0,D0
000011C6  C0BC FFFFFFC0            359              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011CC  2040                     360              MOVE.L  D0,A0
000011CE  4250                     361              CLR.W   (A0)
000011D0  4CDF 0101                362              MOVEM.L (A7)+,D0/A0
000011D4  4E75                     363              RTS
000011D4  4E75                     364  -------------------- end include --------------------
000011D6                           365              INCLUDE "CONST.X68"             ; GAME CONSTANTS
000011D6                           366  ; =============================================================================
000011D6                           367  ; TITLE    : GAME CONSTANTS
000011D6                           368  ; AUTHOR   :
000011D6                           369  ; HISTORY  :
000011D6                           370  ; =============================================================================
000011D6                           371  
000011D6                           372  ; TILE RELATED CONSTANTS 
000011D6  =00000020                373  TILEDIM     EQU     32         ; TILE SET DIMENSIONS && PLAYER SPEED
000011D6  =00745B6D                374  TILEDARK    EQU     $00745B6D  ; TILE SET DARK COLOR 
000011D6  =00CCE0EA                375  TILELIGH    EQU     $00CCE0EA  ; TILE SET LIGHT COLOR
000011D6  =00A38099                376  TILEDETA    EQU     $00A38099  ; TILE SET DETAIL COLOR
000011D6                           377  
000011D6                           378  ; STRINGS 
000011D6= 594F 5520 444F 2...      379  NOKEYSTRING DC.W    'YOU DO NOT HAVE ANY KEYS', 0
000011F0= 534F 4D45 2050 4...      380  DEATHSTRING DC.W    'SOME PART OF YOUR SOUL FADES AWAY', 0
00001214= 594F 5520 4841 4...      381  SUSSERTOD   DC.W    'YOU HAD SO MUCH TO LIVE FOR, YET YOU WENT DOWN THE DUNGEON', 0
00001250= 204C 4556 454C 3...      382  LEVELSTRING DC.W    ' LEVEL: ', 0
0000125A                           383  
0000125A  =0000000C                384  ENEMYMAXCNT EQU     12                      
0000125A                           385  
0000125A                           386  ; ID'S FOR AGENTS AND MATRIX IN CASE TORCH SHADER IS IMPLEMENTED
0000125A  =00000001                387  EMPTYID     EQU     1                       ; VOID IDENTIFIER
0000125A  =00000002                388  WALLID      EQU     2                       ; WALL IDENTIFIER
0000125A  =00000003                389  FLOORID     EQU     3                       ; FLOOR IDENTIFIER | ONLY USEFUL IF TILE SET IS IMPLEMENTED
0000125A  =00000004                390  STAIRID     EQU     4                       ; STAIR IDENTIFIER
0000125A  =00000005                391  KEYID       EQU     5                       ; KEY IDENTIFIER
0000125A  =00000006                392  PLYRID      EQU     6                       ; PLAYER IDENTIFIER
0000125A  =00000007                393  ENEMYID     EQU     7                       ; TRAP IDENTIFIER
0000125A                           394  
0000125A                           395  ; PSEUDO-RANDOM GENERATOR VECTORS
0000125A= 0100 0220 0180 0...      396  XVALUES     DC.W    $100, $220, $180, $1C0, $80, $C0, $200, $E0, $160, $120
0000126E= 0060 01E0 00A0 0...      397              DC.W    $60, $1E0, $A0, $1A0, $140
00001278                           398  
00001278= 00D0 0090 00B0 0...      399  YVALUES     DC.W    $D0, $90, $B0, $F0, $B0, $90, $190, $110, $170, $190
0000128C= 00B0 01B0 00B0 0...      400              DC.W    $B0, $1B0, $B0, $130, $D0, $50, $170, $190, $130, $110
000012A0= 01B0 0150 0090 0...      401              DC.W    $1B0, $150, $90, $90, $110, $30, $70, $150, $90, $10
000012B4= 01B0 00F0 00D0 0...      402              DC.W    $1B0, $F0, $D0, $D0, $90, $1B0, $B0, $170, $130, $190
000012C8= 00F0 0030 0150 0...      403              DC.W    $F0, $30, $150, $50, $170, $110, $1B0, $170, $150, $150
000012DC= 0070 01B0 0030 0...      404              DC.W    $70, $1B0, $30, $F0, $10, $90, $F0, $70, $D0, $170
000012F0= 0050 00B0 00D0 0...      405              DC.W    $50, $B0, $D0, $190, $90, $170, $50, $50, $50, $90
00001304= 0090 01B0 0030 0...      406              DC.W    $90, $1B0, $30, $110, $130, $50, $B0, $110, $F0, $70
00001318= 0010 01B0 0110 0...      407              DC.W    $10, $1B0, $110, $50, $D0, $F0, $F0, $30, $30, $150
0000132C= 00B0 0030 0110 0...      408              DC.W    $B0, $30, $110, $110, $1B0, $190, $30, $30, $170, $170
00001340= 0030 0190 0130 0...      409              DC.W    $30, $190, $130, $90, $50, $90, $110, $150, $190, $110
00001354= 0050 0110 00F0 0...      410              DC.W    $50, $110, $F0, $190, $1B0, $170, $70, $1B0, $F0, $1B0
00001368= 0050 0130 0150 0...      411              DC.W    $50, $130, $150, $130, $70, $30, $D0, $150, $50, $130
0000137C= 00B0 0010 0010 0...      412              DC.W    $B0, $10, $10, $30, $90, $F0, $B0, $70, $B0, $70
00001390= 0070 00B0 0010 0...      413              DC.W    $70, $B0, $10, $130, $70, $70, $150, $B0, $130, $1B0
000013A4= 0030 0190 0130 0...      414              DC.W    $30, $190, $130, $D0, $10, $1D0, $150, $110, $F0, $10
000013B8= 0190 0070 0130 0...      415              DC.W    $190, $70, $130, $F0, $10, $70, $10, $30, $190, $D0
000013CC= 0170 0150 0010 0...      416              DC.W    $170, $150, $10, $50, $170, $D0, $F0, $B0, $B0, $D0
000013E0= 0190 0090 00B0 0...      417              DC.W    $190, $90, $B0, $90, $190, $10, $110, $90, $110, $130
000013F4= 0010 0050 00D0 0...      418              DC.W    $10, $50, $D0, $50, $1B0, $170, $F0, $150, $F0, $10
00001408= 0150 0070 0170 0...      419              DC.W    $150, $70, $170, $110, $D0, $50, $1B0, $30, $150, $170
0000141C= 0130 0030 0070 0...      420              DC.W    $130, $30, $70, $190, $130, $30, $150, $130, $190, $10
00001430= 0010 00D0 0070 0...      421              DC.W    $10, $D0, $70, $D0, $B0
00001430= 0010 00D0 0070 0...      422  -------------------- end include --------------------
0000143A                           423              INCLUDE "UTIL.X68"              ; UTILITY MANAGER
0000143A                           424  UTILPEN     MACRO
0000143A                           425  ;   IN:  \1 AS THE COLOR, FORMATED AS #00BBGGRR
0000143A                           426  ;   OUT: NONE
0000143A                           427  ;   MOD: D0, D1    
0000143A                           428  ;   DES: MACRO TO SET PEN COLOR
0000143A                           429  
0000143A                           430          MOVE.B  #80, D0 
0000143A                           431          MOVE.L  \1, D1
0000143A                           432          TRAP    #15
0000143A                           433          ENDM
0000143A                           434  
0000143A                           435  UTILFILL    MACRO
0000143A                           436  ;   IN:  \1 AS THE COLOR, FORMATED AS #00BBGGRR
0000143A                           437  ;   OUT: NONE
0000143A                           438  ;   MOD: D0, D1
0000143A                           439  ;   DES: MACRO TO SET FILL COLOR
0000143A                           440  
0000143A                           441          MOVE.B  #81, D0
0000143A                           442          MOVE.L  \1, D1
0000143A                           443          TRAP    #15
0000143A                           444          ENDM
0000143A                           445  
0000143A                           446  UTILTEXT    MACRO
0000143A                           447  ;   IN:  \1 TEXT 
0000143A                           448  ;        \2 TEXT X
0000143A                           449  ;        \3 TEXT Y
0000143A                           450  ;   OUT: NONE
0000143A                           451  ;   MOD: D0-D2 / A1
0000143A                           452  ;   DES: PRINTS THE 0 TERINATED STRING IN \1 IN COORDINATES \2 \3
0000143A                           453  
0000143A                           454          LEA     \1, A1
0000143A                           455          MOVE.W  \2, D1
0000143A                           456          MOVE.W  \3, D2
0000143A                           457  
0000143A                           458          MOVE.W  #95, D0
0000143A                           459          TRAP    #15
0000143A                           460          ENDM
0000143A                           461  
0000143A                           462  UTILTILE    MACRO
0000143A                           463  ;   IN:  \1 PROCEDURE OF THE TRAP #15
0000143A                           464  ;        \2 X COORDINATE
0000143A                           465  ;        \3 Y COORDINATE
0000143A                           466  ;   OUT: NONE
0000143A                           467  ;   MOD: D1-D4
0000143A                           468  ;   DES: DRAWS A GRAPHIC AT \2 \3
0000143A                           469          MOVE.W  \2, D1               ; D1 = X CENTER
0000143A                           470          MOVE.W  \3, D2               ; D1 = Y CENTER
0000143A                           471          MOVE.W  D1, D3
0000143A                           472          MOVE.W  D2, D4
0000143A                           473          SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
0000143A                           474          SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
0000143A                           475          ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
0000143A                           476          ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
0000143A                           477  
0000143A                           478          MOVE.W  \1, D0
0000143A                           479          TRAP    #15
0000143A                           480          ENDM
0000143A                           481  
0000143A                           482  UTILCOLL    
0000143A                           483  ;   IN:  D0 X0 COORDINATE
0000143A                           484  ;        D1 Y0 COORDINATE
0000143A                           485  ;   OUT: D2.B = FF IF COLLISION, 00 ELSEWISE
0000143A                           486  ;   MOD: D2
0000143A                           487  ;   DES: CHECKS IF ELEMENTS 0 AND 1 HAVE THE SAME POSITION 
0000143A                           488  
0000143A  4242                     489          CLR     D2
0000143C  B079 00002700            490          CMP.W   (PLAYERX), D0   ; COMPARE X COORDINATES
00001442  6600 0010                491          BNE .NOCOL
00001446  B279 00002702            492          CMP.W   (PLAYERY), D1   ; COMPARE Y COORDINATES
0000144C  6600 0006                493          BNE .NOCOL
00001450  143C 00FF                494          MOVE.B  #$FF, D2
00001454                           495  .NOCOL
00001454  4E75                     496          RTS
00001456                           497  
00001456                           498  
00001456                           499      
00001456                           500  -------------------- end include --------------------
00001456                           501              INCLUDE "RANDOM.X68"            ; PSEUDO - RANDOM GENERATOR
00001456                           502  ; =============================================================================
00001456                           503  ; TITLE    : PSEUDO-RANDOM NUMBER GENERATOR
00001456                           504  ; AUTHOR   : ANTONI BURGUERA
00001456                           505  ; COMMENTS : VERY LAZY AND STUPID "ALGORITHM" IMPLEMENTED.
00001456                           506  ; HISTORY  : XX-XXX-201X - CREATION
00001456                           507  ;            11-OCT-2020 - MINOR CHANGES
00001456                           508  ; =============================================================================
00001456                           509  
00001456                           510  ; -----------------------------------------------------------------------------
00001456                           511  RNDINIT
00001456                           512  ; INITIALIZES RANDOM NUMBER GENERATOR
00001456                           513  ; INPUT    - NONE
00001456                           514  ; OUTPUT   - NONE
00001456                           515  ; MODIFIES - NONE
00001456                           516  ; -----------------------------------------------------------------------------
00001456  4279 00002712            517              CLR     (RNGXINDEX)
0000145C  4279 00002714            518              CLR     (RNGYINDEX)
00001462                           519  
00001462  4E75                     520              RTS
00001464                           521  ; -----------------------------------------------------------------------------
00001464                           522  RNGX
00001464                           523  ; PROVIDES A PSEUDO-RANDOM BYTE
00001464                           524  ; INPUT    - NONE
00001464                           525  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001464                           526  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001464                           527  ; -----------------------------------------------------------------------------
00001464  2F08                     528              MOVE.L  A0,-(A7)
00001466                           529  
00001466  41F8 125A                530              LEA     XVALUES, A0
0000146A  4280                     531              CLR.L   D0
0000146C                           532              
0000146C  1039 00002712            533              MOVE.B  (RNGXINDEX), D0
00001472  E348                     534              LSL.W   #1, D0     
00001474  D0C0                     535              ADD.W   D0, A0
00001476  3010                     536              MOVE.W  (A0), D0
00001478  5239 00002712            537              ADDQ.B  #1, (RNGXINDEX)
0000147E  0C79 0C00 00002712       538              CMP     #$0C00, (RNGXINDEX)
00001486  6600 0008                539              BNE     .NOVERFLOW     
0000148A  4279 00002712            540              CLR     (RNGXINDEX)
00001490                           541  .NOVERFLOW            
00001490  205F                     542              MOVE.L  (A7)+, A0
00001492  4E75                     543              RTS
00001494                           544  
00001494                           545  RNGY
00001494                           546  ; PROVIDES A PSEUDO-RANDOM BYTE
00001494                           547  ; INPUT    - NONE
00001494                           548  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001494                           549  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001494                           550  ; -----------------------------------------------------------------------------
00001494  2F08                     551              MOVE.L  A0,-(A7)
00001496                           552  
00001496  41F8 1278                553              LEA     YVALUES, A0
0000149A  4280                     554              CLR.L   D0
0000149C                           555              
0000149C  1039 00002714            556              MOVE.B  (RNGYINDEX), D0
000014A2  E348                     557              LSL.W   #1, D0  
000014A4  D0C0                     558              ADD.W   D0, A0
000014A6  3010                     559              MOVE.W  (A0), D0
000014A8  5239 00002714            560              ADDQ.B  #1, (RNGYINDEX)
000014AE  0C79 E100 00002714       561              CMP     #$E100, (RNGYINDEX)
000014B6  6600 0008                562              BNE     .NOVERFLOW
000014BA  4279 00002714            563              CLR     (RNGYINDEX)
000014C0                           564  .NOVERFLOW
000014C0  205F                     565              MOVE.L  (A7)+, A0
000014C2  4E75                     566              RTS
000014C4                           567  
000014C4                           568  ; UPDATE RANDOM VALUES TO HAVE ONLY CENTER VALUES OF THE "GRID"
000014C4                           569  -------------------- end include --------------------
000014C4                           570              INCLUDE "AGENTLST.X68"          ; AGENT MANAGER
000014C4                           571  ; =============================================================================
000014C4                           572  ; TITLE    : AGENT LIST
000014C4                           573  ; AUTHOR   : ANTONI BURGUERA
000014C4                           574  ; COMMENTS : EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014C4                           575  ;              +0 - LONG : UPDATE SUBROUTINE POINTER
000014C4                           576  ;              +4 - LONG : PLOT SUBROUTINE POINTER
000014C4                           577  ;              +8:END    : DATA (AGENT SPECIFIC)
000014C4                           578  ; HISTORY  : XX-XXX-201X - CREATION
000014C4                           579  ;            11-OCT-2020 - MINOR CHANGES
000014C4                           580  ; =============================================================================
000014C4                           581  
000014C4                           582  ; -----------------------------------------------------------------------------
000014C4                           583  AGLADD
000014C4                           584  ; CREATES A NEW AGENT
000014C4                           585  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014C4                           586  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014C4                           587  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014C4                           588  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014C4                           589  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014C4                           590  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014C4                           591  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014C4                           592  ; OUTPUT   - NONE
000014C4                           593  ; MODIFIES - NONE
000014C4                           594  ; -----------------------------------------------------------------------------
000014C4  2F08                     595              MOVE.L  A0,-(A7)
000014C6  4EB8 11A6                596              JSR     DMMALLOC
000014CA  B1FC 00000000            597              CMP.L   #0,A0
000014D0  6700 0008                598              BEQ     .END
000014D4  20CA                     599              MOVE.L  A2,(A0)+
000014D6  20CB                     600              MOVE.L  A3,(A0)+
000014D8  4E91                     601              JSR     (A1)
000014DA  205F                     602  .END        MOVE.L  (A7)+,A0
000014DC  4E75                     603              RTS
000014DE                           604  
000014DE                           605  ; -----------------------------------------------------------------------------
000014DE                           606  AGLUPDT
000014DE                           607  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014DE                           608  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014DE                           609  ; INPUT    - NONE
000014DE                           610  ; OUTPUT   - NONE
000014DE                           611  ; MODIFIES - NONE
000014DE                           612  ; -----------------------------------------------------------------------------
000014DE  48E7 00C0                613              MOVEM.L A0-A1,-(A7)
000014E2  4EB8 1136                614              JSR     DMMFIRST
000014E6  B1FC 00000000            615  .LOOP       CMP.L   #0,A0
000014EC  6700 000E                616              BEQ     .END
000014F0  2250                     617              MOVE.L  (A0),A1
000014F2  5088                     618              ADD.L   #8,A0
000014F4  4E91                     619              JSR     (A1)
000014F6  4EB8 1158                620              JSR     DMMNEXT
000014FA  60EA                     621              BRA     .LOOP
000014FC  4CDF 0300                622  .END        MOVEM.L (A7)+,A0-A1
00001500  4E75                     623              RTS
00001502                           624  
00001502                           625  ; -----------------------------------------------------------------------------
00001502                           626  AGLPLOT
00001502                           627  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001502                           628  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001502                           629  ; INPUT    - NONE
00001502                           630  ; OUTPUT   - NONE
00001502                           631  ; MODIFIES - NONE
00001502                           632  ; -----------------------------------------------------------------------------
00001502  48E7 00C0                633              MOVEM.L A0-A1,-(A7)
00001506  4EB8 1136                634              JSR     DMMFIRST
0000150A  B1FC 00000000            635  .LOOP       CMP.L   #0,A0
00001510  6700 0010                636              BEQ     .END
00001514  2268 0004                637              MOVE.L  4(A0),A1
00001518  5088                     638              ADD.L   #8,A0
0000151A  4E91                     639              JSR     (A1)
0000151C  4EB8 1158                640              JSR     DMMNEXT
00001520  60E8                     641              BRA     .LOOP
00001522  4CDF 0300                642  .END        MOVEM.L (A7)+,A0-A1
00001526  4E75                     643              RTS
00001528                           644  
00001528                           645  ; -----------------------------------------------------------------------------
00001528  =000011C0                646  AGLKILL     EQU     DMMFREE
00001528                           647  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001528                           648  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001528                           649  ; OUTPUT   - NONE
00001528                           650  ; MODIFIES - NONE
00001528                           651  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001528                           652  ; -----------------------------------------------------------------------------
00001528                           653  
00001528                           654  AGLFKIL
00001528                           655  ; KILLS ALL AGENTS WITH ID 'X'
00001528                           656  ; INPUT    - D0 AGENT ID
00001528  48E7 00C0                657              MOVEM.L A0-A1,-(A7)
0000152C  4EB8 116E                658              JSR     DMMFRSTO
00001530  B1FC 00000000            659  .LOOP       CMP.L   #0, A0
00001536  6700 000C                660              BEQ     .END            ; AGENT LIST IS EMPTY
0000153A  4EB8 11C0                661              JSR     AGLKILL
0000153E  4EB8 116E                662              JSR     DMMFRSTO        ; SEARCH NEXT AGENT WITH ID D0
00001542  60EC                     663              BRA     .LOOP
00001544  4CDF 0300                664  .END        MOVEM.L (A7)+,A0-A1
00001548  4E75                     665              RTS
00001548  4E75                     666  -------------------- end include --------------------
0000154A                           667              INCLUDE "PLAYER.X68"            ; PLAYER MANAGER
0000154A                           668  ; =============================================================================
0000154A                           669  ; TITLE    : PLAYER MANAGER
0000154A                           670  ; AUTHOR   : 
0000154A                           671  ; COMMENTS : 
0000154A                           672  ; =============================================================================
0000154A                           673  
0000154A                           674  
0000154A                           675  PLAYERINIT
0000154A  33FC 0140 00002700       676              MOVE.W #SCRWIDTH/2, (PLAYERX)       ; SET PLAYER TO CENTER
00001552  33FC 00F0 00002702       677              MOVE.W #SCRHEIGH/2, (PLAYERY)       ; SET PLAYER TO CENTER
0000155A  4E75                     678              RTS
0000155C                           679  
0000155C                           680  PLAYERUPDT  
0000155C  0839 0000 00001A48       681              BTST.B  #KBDBITLF, (KBDVAL)         ; LEFT KEY PRESSED
00001564  6600 0028                682              BNE     .MOVEL
00001568  0839 0002 00001A48       683              BTST.B  #KBDBITRT, (KBDVAL)         ; RIGHT KEY PRESSED
00001570  6600 0034                684              BNE     .MOVER
00001574  0839 0001 00001A48       685              BTST.B  #KBDBITUP, (KBDVAL)         ; UP KEY PRESSED
0000157C  6600 0040                686              BNE     .MOVEU
00001580  0839 0003 00001A48       687              BTST.B  #KBDBITDN, (KBDVAL)         ; DOWN KEY PRESSED
00001588  6600 004C                688              BNE     .MOVED
0000158C  4E75                     689              RTS
0000158E                           690  .MOVEL
0000158E  0C79 0070 00002700       691              CMP.W   #TILEDIM/2+(SCRWIDTH-SCRHEIGH)-64, (PLAYERX)       ; LEFT BOUNDARY
00001596  6E00 0004                692              BGT     .RMVEL
0000159A  4E75                     693              RTS
0000159C                           694  .RMVEL
0000159C  0479 0020 00002700       695              SUB.W   #TILEDIM, (PLAYERX)         ; MOVE LEFT
000015A4  4E75                     696              RTS
000015A6                           697  
000015A6                           698  .MOVER
000015A6  0C79 020F 00002700       699              CMP.W   #SCRHEIGH-1-TILEDIM/2+64, (PLAYERX)    ; RIGHT BOUNDARY
000015AE  6D00 0004                700              BLT     .RMVER
000015B2  4E75                     701              RTS
000015B4                           702  .RMVER
000015B4  0679 0020 00002700       703              ADD.W   #TILEDIM, (PLAYERX)         ; MOVE RIGHT
000015BC  4E75                     704              RTS
000015BE                           705  
000015BE                           706  .MOVEU
000015BE  0C79 0010 00002702       707              CMP.W   #TILEDIM/2, (PLAYERY)       ; TOP BOUNDARY
000015C6  6E00 0004                708              BGT     .RMVEU
000015CA  4E75                     709              RTS
000015CC                           710  .RMVEU
000015CC  0479 0020 00002702       711              SUB.W   #TILEDIM, (PLAYERY)         ; MOVE UP
000015D4  4E75                     712              RTS
000015D6                           713  
000015D6                           714  .MOVED
000015D6  0C79 01CF 00002702       715              CMP.W   #SCRHEIGH-1-TILEDIM/2, (PLAYERY)    ; BOTTOM BOUNDARY
000015DE  6D00 0004                716              BLT     .RMVED
000015E2  4E75                     717              RTS
000015E4                           718  .RMVED
000015E4  0679 0020 00002702       719              ADD.W   #TILEDIM, (PLAYERY)         ; MOVE DOWN
000015EC  4E75                     720              RTS
000015EE                           721  
000015EE                           722  PLAYERPLOT
000015EE  48E7 F800                723              MOVEM.L D0-D4, -(A7)
000015F2                           724m             UTILPEN #TILELIGH                         
000015F2                           725m ;   IN:  #TILELIGH AS THE COLOR, FORMATED AS #00BBGGRR
000015F2                           726m ;   OUT: NONE
000015F2                           727m ;   MOD: D0, D1    
000015F2                           728m ;   DES: MACRO TO SET PEN COLOR
000015F2                           729m 
000015F2  103C 0050                730m         MOVE.B  #80, D0 
000015F6  223C 00CCE0EA            731m         MOVE.L  #TILELIGH, D1
000015FC  4E4F                     732m         TRAP    #15
000015FE                           733m         ENDM
000015FE                           734  
000015FE                           735m             UTILFILL #TILELIGH
000015FE                           736m ;   IN:  #TILELIGH AS THE COLOR, FORMATED AS #00BBGGRR
000015FE                           737m ;   OUT: NONE
000015FE                           738m ;   MOD: D0, D1
000015FE                           739m ;   DES: MACRO TO SET FILL COLOR
000015FE                           740m 
000015FE  103C 0051                741m         MOVE.B  #81, D0
00001602  223C 00CCE0EA            742m         MOVE.L  #TILELIGH, D1
00001608  4E4F                     743m         TRAP    #15
0000160A                           744m         ENDM
0000160A                           745              
0000160A                           746m             UTILTILE #87, (PLAYERX), (PLAYERY)
0000160A                           747m ;   IN:  #87 PROCEDURE OF THE TRAP #15
0000160A                           748m ;        (PLAYERX) X COORDINATE
0000160A                           749m ;        (PLAYERY) Y COORDINATE
0000160A                           750m ;   OUT: NONE
0000160A                           751m ;   MOD: D1-D4
0000160A                           752m ;   DES: DRAWS A GRAPHIC AT (PLAYERX) (PLAYERY)
0000160A  3239 00002700            753m         MOVE.W  (PLAYERX), D1               ; D1 = X CENTER
00001610  3439 00002702            754m         MOVE.W  (PLAYERY), D2               ; D1 = Y CENTER
00001616  3601                     755m         MOVE.W  D1, D3
00001618  3802                     756m         MOVE.W  D2, D4
0000161A  0441 0010                757m         SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
0000161E  0442 0010                758m         SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
00001622  0643 0010                759m         ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
00001626  0644 0010                760m         ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
0000162A                           761m 
0000162A  303C 0057                762m         MOVE.W  #87, D0
0000162E  4E4F                     763m         TRAP    #15
00001630                           764m         ENDM
00001630  4CDF 001F                765              MOVEM.L (A7)+,D0-D4
00001634  4E75                     766              RTS
00001636                           767  
00001636                           768  DEATH      ; PLAYER HAS 0 LIVES
00001636                           769  
00001636                           770              ; -- BLACK SQUARE ---
00001636                           771m         UTILPEN #0                       
00001636                           772m ;   IN:  #0 AS THE COLOR, FORMATED AS #00BBGGRR
00001636                           773m ;   OUT: NONE
00001636                           774m ;   MOD: D0, D1    
00001636                           775m ;   DES: MACRO TO SET PEN COLOR
00001636                           776m 
00001636  103C 0050                777m         MOVE.B  #80, D0 
0000163A  7200                     778m         MOVE.L  #0, D1
0000163C  4E4F                     779m         TRAP    #15
0000163E                           780m         ENDM
0000163E                           781m         UTILFILL #0
0000163E                           782m ;   IN:  #0 AS THE COLOR, FORMATED AS #00BBGGRR
0000163E                           783m ;   OUT: NONE
0000163E                           784m ;   MOD: D0, D1
0000163E                           785m ;   DES: MACRO TO SET FILL COLOR
0000163E                           786m 
0000163E  103C 0051                787m         MOVE.B  #81, D0
00001642  7200                     788m         MOVE.L  #0, D1
00001644  4E4F                     789m         TRAP    #15
00001646                           790m         ENDM
00001646                           791  
00001646  323C 0000                792          MOVE.W  #0, D1               ; D1 = X CENTER
0000164A  343C 0000                793          MOVE.W  #0, D2               ; D1 = Y CENTER
0000164E  363C 0280                794          MOVE.W  #SCRWIDTH, D3
00001652  383C 01E0                795          MOVE.W  #SCRHEIGH, D4
00001656                           796  
00001656  303C 0057                797          MOVE.W  #87, D0
0000165A  4E4F                     798          TRAP    #15
0000165C                           799  
0000165C                           800          ; --- TEXT ---
0000165C                           801m         UTILFILL #0
0000165C                           802m ;   IN:  #0 AS THE COLOR, FORMATED AS #00BBGGRR
0000165C                           803m ;   OUT: NONE
0000165C                           804m ;   MOD: D0, D1
0000165C                           805m ;   DES: MACRO TO SET FILL COLOR
0000165C                           806m 
0000165C  103C 0051                807m         MOVE.B  #81, D0
00001660  7200                     808m         MOVE.L  #0, D1
00001662  4E4F                     809m         TRAP    #15
00001664                           810m         ENDM
00001664                           811  
00001664                           812m         UTILTEXT DEATHSTRING, #SCRWIDTH/2-230, #SCRHEIGH/3
00001664                           813m ;   IN:  DEATHSTRING TEXT 
00001664                           814m ;        #SCRWIDTH/2-230 TEXT X
00001664                           815m ;        #SCRHEIGH/3 TEXT Y
00001664                           816m ;   OUT: NONE
00001664                           817m ;   MOD: D0-D2 / A1
00001664                           818m ;   DES: PRINTS THE 0 TERINATED STRING IN DEATHSTRING IN COORDINATES #SCRWIDTH/2-230 #SCRHEIGH/3
00001664                           819m 
00001664  43F8 11F0                820m         LEA     DEATHSTRING, A1
00001668  323C 005A                821m         MOVE.W  #SCRWIDTH/2-230, D1
0000166C  343C 00A0                822m         MOVE.W  #SCRHEIGH/3, D2
00001670                           823m 
00001670  303C 005F                824m         MOVE.W  #95, D0
00001674  4E4F                     825m         TRAP    #15
00001676                           826m         ENDM
00001676                           827  
00001676                           828m         UTILTEXT SUSSERTOD, #SCRWIDTH/2-230, #SCRHEIGH/2
00001676                           829m ;   IN:  SUSSERTOD TEXT 
00001676                           830m ;        #SCRWIDTH/2-230 TEXT X
00001676                           831m ;        #SCRHEIGH/2 TEXT Y
00001676                           832m ;   OUT: NONE
00001676                           833m ;   MOD: D0-D2 / A1
00001676                           834m ;   DES: PRINTS THE 0 TERINATED STRING IN SUSSERTOD IN COORDINATES #SCRWIDTH/2-230 #SCRHEIGH/2
00001676                           835m 
00001676  43F8 1214                836m         LEA     SUSSERTOD, A1
0000167A  323C 005A                837m         MOVE.W  #SCRWIDTH/2-230, D1
0000167E  343C 00F0                838m         MOVE.W  #SCRHEIGH/2, D2
00001682                           839m 
00001682  303C 005F                840m         MOVE.W  #95, D0
00001686  4E4F                     841m         TRAP    #15
00001688                           842m         ENDM
00001688                           843  
00001688  4E41                     844          TRAP    #SCRTRAP                ; SHOW GRAPHICS
0000168A  4EB9 00001A44            845          JSR     LOOSE
0000168A  4EB9 00001A44            846  -------------------- end include --------------------
00001690                           847              INCLUDE "MAP.X68"               ; MAP MANAGER
00001690                           848  MAPINIT
00001690  4E75                     849          RTS      
00001692                           850  MAPUPDT
00001692  4E75                     851          RTS
00001694                           852  MAPPLOT
00001694  48E7 F800                853          MOVEM.L D0-D4, -(A7)
00001698                           854  
00001698                           855          
00001698                           856          
00001698                           857m         UTILPEN #TILEDARK
00001698                           858m ;   IN:  #TILEDARK AS THE COLOR, FORMATED AS #00BBGGRR
00001698                           859m ;   OUT: NONE
00001698                           860m ;   MOD: D0, D1    
00001698                           861m ;   DES: MACRO TO SET PEN COLOR
00001698                           862m 
00001698  103C 0050                863m         MOVE.B  #80, D0 
0000169C  223C 00745B6D            864m         MOVE.L  #TILEDARK, D1
000016A2  4E4F                     865m         TRAP    #15
000016A4                           866m         ENDM
000016A4                           867m         UTILFILL #TILEDARK
000016A4                           868m ;   IN:  #TILEDARK AS THE COLOR, FORMATED AS #00BBGGRR
000016A4                           869m ;   OUT: NONE
000016A4                           870m ;   MOD: D0, D1
000016A4                           871m ;   DES: MACRO TO SET FILL COLOR
000016A4                           872m 
000016A4  103C 0051                873m         MOVE.B  #81, D0
000016A8  223C 00745B6D            874m         MOVE.L  #TILEDARK, D1
000016AE  4E4F                     875m         TRAP    #15
000016B0                           876m         ENDM
000016B0                           877  
000016B0  4241                     878          CLR     D1                          ; LEFT BORDER
000016B2  4242                     879          CLR     D2                      
000016B4  363C 004F                880          MOVE.W  #79, D3
000016B8  383C 01E0                881          MOVE.W  #SCRHEIGH, D4
000016BC  303C 0057                882          MOVE.W  #87, D0
000016C0  4E4F                     883          TRAP    #15
000016C2                           884  
000016C2  323C 0231                885          MOVE.W  #561, D1                    ; RIGHT BORDER                                
000016C6  363C 0280                886          MOVE.W  #SCRWIDTH, D3
000016CA  4E4F                     887          TRAP    #15
000016CC                           888  
000016CC  4240                     889          CLR     D0
000016CE  4241                     890          CLR     D1
000016D0                           891  
000016D0                           892m         UTILPEN #TILEDETA
000016D0                           893m ;   IN:  #TILEDETA AS THE COLOR, FORMATED AS #00BBGGRR
000016D0                           894m ;   OUT: NONE
000016D0                           895m ;   MOD: D0, D1    
000016D0                           896m ;   DES: MACRO TO SET PEN COLOR
000016D0                           897m 
000016D0  103C 0050                898m         MOVE.B  #80, D0 
000016D4  223C 00A38099            899m         MOVE.L  #TILEDETA, D1
000016DA  4E4F                     900m         TRAP    #15
000016DC                           901m         ENDM
000016DC                           902m         UTILFILL #TILEDETA
000016DC                           903m ;   IN:  #TILEDETA AS THE COLOR, FORMATED AS #00BBGGRR
000016DC                           904m ;   OUT: NONE
000016DC                           905m ;   MOD: D0, D1
000016DC                           906m ;   DES: MACRO TO SET FILL COLOR
000016DC                           907m 
000016DC  103C 0051                908m         MOVE.B  #81, D0
000016E0  223C 00A38099            909m         MOVE.L  #TILEDETA, D1
000016E6  4E4F                     910m         TRAP    #15
000016E8                           911m         ENDM
000016E8                           912  
000016E8  4CDF 001F                913          MOVEM.L (A7)+,D0-D4
000016EC                           914  
000016EC  4E75                     915          RTS
000016EC  4E75                     916  -------------------- end include --------------------
000016EE                           917              INCLUDE "KEY.X68"               ; KEY MANAGER
000016EE                           918  KEYINIT             ; RANDOM POSITION
000016EE  2F00                     919              MOVE.L D0, -(A7)
000016F0  4EB8 1464                920              JSR     RNGX
000016F4  33C0 00002704            921              MOVE.W  D0, (KEYX)
000016FA  4EB8 1494                922              JSR     RNGY
000016FE  33C0 00002706            923              MOVE.W  D0, (KEYY)
00001704  201F                     924              MOVE.L  (A7)+, D0
00001706  4E75                     925              RTS
00001708                           926  KEYUPDT             ; NOTHING
00001708  48E7 E000                927              MOVEM.L D0-D2, -(A7)
0000170C                           928             
0000170C  3039 00002704            929              MOVE.W  (KEYX), D0
00001712  3239 00002706            930              MOVE.W  (KEYY), D1
00001718  4EB8 143A                931              JSR     UTILCOLL
0000171C  B43C 00FF                932              CMP.B   #$FF, D2
00001720  6600 000A                933              BNE     .END
00001724  13FC 0001 00002710       934              MOVE.B  #1, (KEYOBTEINED)           ; THE PLAYER IS IN THE POSITION OF THE KEY
0000172C                           935  .END
0000172C  4CDF 0007                936              MOVEM.L (A7)+, D0-D2
00001730  4E75                     937              RTS
00001732                           938  
00001732                           939  KEYPLOT             ; LIGHT BORDERED CIRCLE
00001732  0C39 0001 00002710       940              CMP.B   #1, (KEYOBTEINED)
0000173A  6700 003C                941              BEQ     .NOKEY
0000173E  48E7 F800                942              MOVEM.L D0-D4, -(A7)
00001742                           943m             UTILPEN #TILELIGH
00001742                           944m ;   IN:  #TILELIGH AS THE COLOR, FORMATED AS #00BBGGRR
00001742                           945m ;   OUT: NONE
00001742                           946m ;   MOD: D0, D1    
00001742                           947m ;   DES: MACRO TO SET PEN COLOR
00001742                           948m 
00001742  103C 0050                949m         MOVE.B  #80, D0 
00001746  223C 00CCE0EA            950m         MOVE.L  #TILELIGH, D1
0000174C  4E4F                     951m         TRAP    #15
0000174E                           952m         ENDM
0000174E                           953  
0000174E                           954m             UTILTILE #91, (KEYX), (KEYY)             
0000174E                           955m ;   IN:  #91 PROCEDURE OF THE TRAP #15
0000174E                           956m ;        (KEYX) X COORDINATE
0000174E                           957m ;        (KEYY) Y COORDINATE
0000174E                           958m ;   OUT: NONE
0000174E                           959m ;   MOD: D1-D4
0000174E                           960m ;   DES: DRAWS A GRAPHIC AT (KEYX) (KEYY)
0000174E  3239 00002704            961m         MOVE.W  (KEYX), D1               ; D1 = X CENTER
00001754  3439 00002706            962m         MOVE.W  (KEYY), D2               ; D1 = Y CENTER
0000175A  3601                     963m         MOVE.W  D1, D3
0000175C  3802                     964m         MOVE.W  D2, D4
0000175E  0441 0010                965m         SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
00001762  0442 0010                966m         SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
00001766  0643 0010                967m         ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
0000176A  0644 0010                968m         ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
0000176E                           969m 
0000176E  303C 005B                970m         MOVE.W  #91, D0
00001772  4E4F                     971m         TRAP    #15
00001774                           972m         ENDM
00001774                           973             
00001774  4CDF 001F                974              MOVEM.L (A7)+,D0-D4
00001778                           975  .NOKEY            
00001778  4E75                     976              RTS
00001778  4E75                     977  -------------------- end include --------------------
0000177A                           978              INCLUDE "STAIRS.X68"            ; STAIR MANAGER 
0000177A                           979  STAIRSINIT          ; RANDOM POSTION
0000177A  2F00                     980              MOVE.L D0, -(A7)
0000177C  4EB8 1464                981              JSR     RNGX
00001780  33C0 00002708            982              MOVE.W  D0, (STAIRSX)
00001786  4EB8 1494                983              JSR     RNGY
0000178A  33C0 0000270A            984              MOVE.W  D0, (STAIRSY)
00001790  201F                     985              MOVE.L  (A7)+, D0
00001792  4E75                     986              RTS
00001794                           987  STAIRSUPDT          
00001794  48E7 E070                988              MOVEM.L D0-D2/A1-A3, -(A7)
00001798  3039 00002708            989              MOVE.W  (STAIRSX), D0
0000179E  3239 0000270A            990              MOVE.W  (STAIRSY), D1
000017A4  4EB8 143A                991              JSR     UTILCOLL
000017A8  B43C 00FF                992              CMP.B   #$FF, D2
000017AC  6600 006C                993              BNE     .END
000017B0                           994              
000017B0                           995              ; THE PLAYER IS IN THE POSITION OF THE STAIRS
000017B0  0C39 0001 00002710       996              CMP.B   #1, (KEYOBTEINED)
000017B8                           997             ;  BNE     .NOKEY
000017B8  4EB8 16EE                998              JSR     KEYINIT
000017BC  4EB8 177A                999              JSR     STAIRSINIT
000017C0                          1000              ;JSR     ENEMYINIT
000017C0                          1001  
000017C0                          1002  ; CREATE ENEMIES BASED ON LEVEL 
000017C0  4280                    1003              CLR.L   D0
000017C2  303C 0007               1004              MOVE.W  #ENEMYID, D0
000017C6  4EB8 1528               1005              JSR     AGLFKIL         
000017CA  3239 00002716           1006              MOVE.W (LEVEL), D1
000017D0                          1007              
000017D0                          1008  .ENEMYADD
000017D0  43F9 0000189E           1009              LEA     ENEMYINIT, A1
000017D6  45F9 000018BA           1010              LEA     ENEMYUPDT, A2
000017DC  47F9 000018DA           1011              LEA     ENEMYPLOT, A3
000017E2  303C 0007               1012              MOVE.W  #ENEMYID, D0
000017E6                          1013              
000017E6  4EB8 14C4               1014              JSR     AGLADD
000017EA  51C9 FFE4               1015              DBRA.W    D1, .ENEMYADD
000017EE                          1016  
000017EE  13FC 0000 00002710      1017              MOVE.B  #0, (KEYOBTEINED)
000017F6  5279 00002716           1018              ADDQ.W  #1, (LEVEL)
000017FC  6000 001C               1019              BRA     .END
00001800                          1020  .NOKEY      ; SAME POSITION NO KEY
00001800                          1021  
00001800  303C 0051               1022              MOVE.W  #81, D0                      ; SET FILL CALL
00001804  7200                    1023              MOVE.L  #0, D1                       ; SET FILL COLOR
00001806  4E4F                    1024              TRAP    #15
00001808                          1025  
00001808                          1026m             UTILTEXT NOKEYSTRING, #SCRWIDTH/2-100, #SCRHEIGH/8  
00001808                          1027m ;   IN:  NOKEYSTRING TEXT 
00001808                          1028m ;        #SCRWIDTH/2-100 TEXT X
00001808                          1029m ;        #SCRHEIGH/8 TEXT Y
00001808                          1030m ;   OUT: NONE
00001808                          1031m ;   MOD: D0-D2 / A1
00001808                          1032m ;   DES: PRINTS THE 0 TERINATED STRING IN NOKEYSTRING IN COORDINATES #SCRWIDTH/2-100 #SCRHEIGH/8
00001808                          1033m 
00001808  43F8 11D6               1034m         LEA     NOKEYSTRING, A1
0000180C  323C 00DC               1035m         MOVE.W  #SCRWIDTH/2-100, D1
00001810  343C 003C               1036m         MOVE.W  #SCRHEIGH/8, D2
00001814                          1037m 
00001814  303C 005F               1038m         MOVE.W  #95, D0
00001818  4E4F                    1039m         TRAP    #15
0000181A                          1040m         ENDM
0000181A                          1041              
0000181A                          1042  .END
0000181A  4CDF 0E07               1043              MOVEM.L (A7)+, D0-D2/A1-A3
0000181E  4E75                    1044              RTS
00001820                          1045              
00001820                          1046  STAIRSPLOT          
00001820  48E7 F800               1047              MOVEM.L D0-D4, -(A7)
00001824                          1048                      
00001824                          1049m             UTILPEN #TILELIGH
00001824                          1050m ;   IN:  #TILELIGH AS THE COLOR, FORMATED AS #00BBGGRR
00001824                          1051m ;   OUT: NONE
00001824                          1052m ;   MOD: D0, D1    
00001824                          1053m ;   DES: MACRO TO SET PEN COLOR
00001824                          1054m 
00001824  103C 0050               1055m         MOVE.B  #80, D0 
00001828  223C 00CCE0EA           1056m         MOVE.L  #TILELIGH, D1
0000182E  4E4F                    1057m         TRAP    #15
00001830                          1058m         ENDM
00001830                          1059m             UTILFILL #TILELIGH 
00001830                          1060m ;   IN:  #TILELIGH AS THE COLOR, FORMATED AS #00BBGGRR
00001830                          1061m ;   OUT: NONE
00001830                          1062m ;   MOD: D0, D1
00001830                          1063m ;   DES: MACRO TO SET FILL COLOR
00001830                          1064m 
00001830  103C 0051               1065m         MOVE.B  #81, D0
00001834  223C 00CCE0EA           1066m         MOVE.L  #TILELIGH, D1
0000183A  4E4F                    1067m         TRAP    #15
0000183C                          1068m         ENDM
0000183C                          1069                              
0000183C  0C39 0001 00002710      1070              CMP.B   #1, (KEYOBTEINED)
00001844  6700 002C               1071              BEQ     .KEYOBTEINED
00001848                          1072m             UTILTILE #88, (STAIRSX), (STAIRSY)
00001848                          1073m ;   IN:  #88 PROCEDURE OF THE TRAP #15
00001848                          1074m ;        (STAIRSX) X COORDINATE
00001848                          1075m ;        (STAIRSY) Y COORDINATE
00001848                          1076m ;   OUT: NONE
00001848                          1077m ;   MOD: D1-D4
00001848                          1078m ;   DES: DRAWS A GRAPHIC AT (STAIRSX) (STAIRSY)
00001848  3239 00002708           1079m         MOVE.W  (STAIRSX), D1               ; D1 = X CENTER
0000184E  3439 0000270A           1080m         MOVE.W  (STAIRSY), D2               ; D1 = Y CENTER
00001854  3601                    1081m         MOVE.W  D1, D3
00001856  3802                    1082m         MOVE.W  D2, D4
00001858  0441 0010               1083m         SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
0000185C  0442 0010               1084m         SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
00001860  0643 0010               1085m         ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
00001864  0644 0010               1086m         ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
00001868                          1087m 
00001868  303C 0058               1088m         MOVE.W  #88, D0
0000186C  4E4F                    1089m         TRAP    #15
0000186E                          1090m         ENDM
0000186E  6000 0028               1091              BRA     .END
00001872                          1092  .KEYOBTEINED
00001872                          1093m             UTILTILE #91, (STAIRSX), (STAIRSY)
00001872                          1094m ;   IN:  #91 PROCEDURE OF THE TRAP #15
00001872                          1095m ;        (STAIRSX) X COORDINATE
00001872                          1096m ;        (STAIRSY) Y COORDINATE
00001872                          1097m ;   OUT: NONE
00001872                          1098m ;   MOD: D1-D4
00001872                          1099m ;   DES: DRAWS A GRAPHIC AT (STAIRSX) (STAIRSY)
00001872  3239 00002708           1100m         MOVE.W  (STAIRSX), D1               ; D1 = X CENTER
00001878  3439 0000270A           1101m         MOVE.W  (STAIRSY), D2               ; D1 = Y CENTER
0000187E  3601                    1102m         MOVE.W  D1, D3
00001880  3802                    1103m         MOVE.W  D2, D4
00001882  0441 0010               1104m         SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
00001886  0442 0010               1105m         SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
0000188A  0643 0010               1106m         ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
0000188E  0644 0010               1107m         ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
00001892                          1108m 
00001892  303C 005B               1109m         MOVE.W  #91, D0
00001896  4E4F                    1110m         TRAP    #15
00001898                          1111m         ENDM
00001898                          1112  
00001898                          1113  .END
00001898  4CDF 001F               1114              MOVEM.L (A7)+,D0-D4
0000189C  4E75                    1115              RTS
0000189E                          1116  
0000189E                          1117  
0000189E                          1118  -------------------- end include --------------------
0000189E                          1119              INCLUDE "ENEMY.X68"             ; ENEMY MANAGER
0000189E                          1120  ;   LOCAL VARIABLES:
0000189E                          1121  ;       XCENTER -   (A0)    WORD
0000189E                          1122  ;       YCENTER -   2(A0)   WORD
0000189E                          1123  ;       ID      -   
0000189E                          1124  
0000189E                          1125  ENEMYINIT
0000189E                          1126                   
0000189E  48E7 C000               1127              MOVEM.L  D0-D1, -(A7)
000018A2  323C 0001               1128              MOVE.W  #1, D1
000018A6                          1129  .CHECKX            
000018A6  4EB8 1464               1130              JSR     RNGX
000018AA  3080                    1131              MOVE.W  D0, (A0)        ; MOVE X COORDINATE TO (A0) | AGENT CONTROL
000018AC                          1132            
000018AC  4EB8 1494               1133  .CHECKY     JSR     RNGY 
000018B0                          1134              
000018B0  3140 0002               1135              MOVE.W  D0, 2(A0)       ; MOVE Y COORDIANTE TO 2(A0) | AGENT CONTROL
000018B4                          1136  
000018B4  4CDF 0003               1137              MOVEM.L  (A7)+, D0-D1
000018B8  4E75                    1138              RTS
000018BA                          1139  
000018BA                          1140  ENEMYUPDT
000018BA  48E7 E000               1141              MOVEM.L D0-D2, -(A7)
000018BE                          1142  
000018BE  3010                    1143              MOVE.W  (A0), D0
000018C0  3228 0002               1144              MOVE.W  2(A0), D1
000018C4  4EB8 143A               1145              JSR     UTILCOLL
000018C8  B43C 00FF               1146              CMP.B   #$FF, D2
000018CC  6600 0006               1147              BNE     .END
000018D0                          1148              ; THE PLAYER IS IN THE POSITION OF THE STAIRS  
000018D0                          1149              
000018D0  4EB8 1636               1150              JSR     DEATH
000018D4                          1151              
000018D4                          1152  .END
000018D4  4CDF 0007               1153              MOVEM.L (A7)+, D0-D2
000018D8  4E75                    1154              RTS
000018DA                          1155  ENEMYPLOT
000018DA  48E7 F800               1156              MOVEM.L D0-D4, -(A7)
000018DE                          1157  
000018DE                          1158m             UTILPEN #TILEDETA                       
000018DE                          1159m ;   IN:  #TILEDETA AS THE COLOR, FORMATED AS #00BBGGRR
000018DE                          1160m ;   OUT: NONE
000018DE                          1161m ;   MOD: D0, D1    
000018DE                          1162m ;   DES: MACRO TO SET PEN COLOR
000018DE                          1163m 
000018DE  103C 0050               1164m         MOVE.B  #80, D0 
000018E2  223C 00A38099           1165m         MOVE.L  #TILEDETA, D1
000018E8  4E4F                    1166m         TRAP    #15
000018EA                          1167m         ENDM
000018EA                          1168              
000018EA                          1169m             UTILFILL #TILEDETA
000018EA                          1170m ;   IN:  #TILEDETA AS THE COLOR, FORMATED AS #00BBGGRR
000018EA                          1171m ;   OUT: NONE
000018EA                          1172m ;   MOD: D0, D1
000018EA                          1173m ;   DES: MACRO TO SET FILL COLOR
000018EA                          1174m 
000018EA  103C 0051               1175m         MOVE.B  #81, D0
000018EE  223C 00A38099           1176m         MOVE.L  #TILEDETA, D1
000018F4  4E4F                    1177m         TRAP    #15
000018F6                          1178m         ENDM
000018F6                          1179              
000018F6                          1180m             UTILTILE #87, (A0), 2(A0)
000018F6                          1181m ;   IN:  #87 PROCEDURE OF THE TRAP #15
000018F6                          1182m ;        (A0) X COORDINATE
000018F6                          1183m ;        2(A0) Y COORDINATE
000018F6                          1184m ;   OUT: NONE
000018F6                          1185m ;   MOD: D1-D4
000018F6                          1186m ;   DES: DRAWS A GRAPHIC AT (A0) 2(A0)
000018F6  3210                    1187m         MOVE.W  (A0), D1               ; D1 = X CENTER
000018F8  3428 0002               1188m         MOVE.W  2(A0), D2               ; D1 = Y CENTER
000018FC  3601                    1189m         MOVE.W  D1, D3
000018FE  3802                    1190m         MOVE.W  D2, D4
00001900  0441 0010               1191m         SUB.W   #TILEDIM/2, D1              ; SET TOP LEFT CORNER
00001904  0442 0010               1192m         SUB.W   #TILEDIM/2, D2              ; SET TOP LEFT CORNER 
00001908  0643 0010               1193m         ADD.W   #TILEDIM/2, D3              ; SET LOW RIGHT CORNER
0000190C  0644 0010               1194m         ADD.W   #TILEDIM/2, D4              ; SET LOW RIGHT CORNER
00001910                          1195m 
00001910  303C 0057               1196m         MOVE.W  #87, D0
00001914  4E4F                    1197m         TRAP    #15
00001916                          1198m         ENDM
00001916                          1199              
00001916  4CDF 001F               1200              MOVEM.L (A7)+,D0-D4
0000191A  4E75                    1201              RTS
0000191A  4E75                    1202  -------------------- end include --------------------
0000191C                          1203              INCLUDE "MISC.X68"              ; MISCELLANEOUS MANAGER
0000191C                          1204  MISCINIT
0000191C  4E75                    1205          RTS
0000191E                          1206  MISCUPDT
0000191E  4E75                    1207          RTS
00001920                          1208          
00001920                          1209  MISCPLOT
00001920  4EB9 00001928           1210          JSR .LVLPLOT
00001926  4E75                    1211          RTS
00001928                          1212  
00001928                          1213  
00001928                          1214  .LVLPLOT
00001928  48E7 E040               1215          MOVEM.L D0-D2/A1, -(A7)
0000192C                          1216          
0000192C                          1217m         UTILFILL #TILEDARK      
0000192C                          1218m ;   IN:  #TILEDARK AS THE COLOR, FORMATED AS #00BBGGRR
0000192C                          1219m ;   OUT: NONE
0000192C                          1220m ;   MOD: D0, D1
0000192C                          1221m ;   DES: MACRO TO SET FILL COLOR
0000192C                          1222m 
0000192C  103C 0051               1223m         MOVE.B  #81, D0
00001930  223C 00745B6D           1224m         MOVE.L  #TILEDARK, D1
00001936  4E4F                    1225m         TRAP    #15
00001938                          1226m         ENDM
00001938                          1227  
00001938  43F8 1250               1228          LEA     LEVELSTRING, A1
0000193C  4281                    1229          CLR.L   D1
0000193E  3239 00002716           1230          MOVE.W  (LEVEL), D1
00001944  103C 0011               1231          MOVE.B  #17,D0
00001948  4E4F                    1232          TRAP    #15
0000194A                          1233          
0000194A  4CDF 0207               1234          MOVEM.L (A7)+, D0-D2/A1
0000194E  4E75                    1235          RTS 
0000194E  4E75                    1236  -------------------- end include --------------------
00001950                          1237              INCLUDE "STATES.X68"            ; STATES MANAGER
00001950                          1238  ; =============================================================================
00001950                          1239  ; TITLE    : GAME STATE MANAGEMENT
00001950                          1240  ; AUTHOR   : ANTONI BURGUERA
00001950                          1241  ; HISTORY  : XX-XXX-201X - CREATION
00001950                          1242  ;            11-OCT-2020 - MINOR CHANGES
00001950                          1243  ; =============================================================================
00001950                          1244  
00001950                          1245  ; -----------------------------------------------------------------------------
00001950                          1246  STAINIT
00001950                          1247  ; INITALIZES THE STATE MANAGER
00001950                          1248  ; INPUT    - NONE
00001950                          1249  ; OUTPUT   - NONE
00001950                          1250  ; MODIFIES - NONE
00001950                          1251  ; -----------------------------------------------------------------------------
00001950  33FC FFFF 0000270C      1252              MOVE.W  #-1,(STACUR)            ; INVALID STATE, JUST TO FORCE INIT
00001958  33FC 0000 0000270E      1253              MOVE.W  #0,(STANEXT)            ; INITIAL STATE
00001960  4E75                    1254              RTS
00001962                          1255  
00001962                          1256  ; -----------------------------------------------------------------------------
00001962                          1257  STAUPD
00001962                          1258  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001962                          1259  ; INPUT    - NONE
00001962                          1260  ; OUTPUT   - NONE
00001962                          1261  ; MODIFIES - NONE
00001962                          1262  ; -----------------------------------------------------------------------------
00001962  48E7 8080               1263              MOVEM.L D0/A0,-(A7)
00001966  4280                    1264              CLR.L   D0
00001968  3039 0000270E           1265              MOVE.W  (STANEXT),D0
0000196E  B079 0000270C           1266              CMP.W   (STACUR),D0
00001974  6700 0012               1267              BEQ     .DOUPD
00001978  33C0 0000270C           1268              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000197E  E588                    1269              LSL.L   #2,D0
00001980  2040                    1270              MOVE.L  D0,A0
00001982  2068 19A0               1271              MOVE.L  .INITBL(A0),A0
00001986  4E90                    1272              JSR     (A0)
00001988  4280                    1273  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000198A  3039 0000270C           1274              MOVE.W  (STACUR),D0
00001990  E588                    1275              LSL.L   #2,D0
00001992  2040                    1276              MOVE.L  D0,A0
00001994  2068 19AC               1277              MOVE.L  .UPDTBL(A0),A0
00001998  4E90                    1278              JSR     (A0)
0000199A  4CDF 0101               1279              MOVEM.L (A7)+,D0/A0
0000199E  4E75                    1280              RTS
000019A0= 000019E0 000019E0 ...   1281  .INITBL     DC.L    STAEMPTY,STAEMPTY,STAEMPTY
000019AC= 000019E0 000019E0 ...   1282  .UPDTBL     DC.L    STAEMPTY,STAEMPTY,STAEMPTY
000019B8                          1283  
000019B8                          1284  ; -----------------------------------------------------------------------------
000019B8                          1285  STAPLOT
000019B8                          1286  ; PERFORMS STATE PLOT
000019B8                          1287  ; INPUT    - NONE
000019B8                          1288  ; OUTPUT   - NONE
000019B8                          1289  ; MODIFIES - NONE
000019B8                          1290  ; -----------------------------------------------------------------------------
000019B8  48E7 8080               1291              MOVEM.L D0/A0,-(A7)
000019BC  4280                    1292              CLR.L   D0
000019BE  3039 0000270C           1293              MOVE.W  (STACUR),D0
000019C4  E588                    1294              LSL.L   #2,D0
000019C6  2040                    1295              MOVE.L  D0,A0
000019C8  2068 19D4               1296              MOVE.L  .PLTTBL(A0),A0
000019CC  4E90                    1297              JSR     (A0)
000019CE  4CDF 0101               1298              MOVEM.L (A7)+,D0/A0
000019D2  4E75                    1299              RTS
000019D4= 000019E0 000019E0 ...   1300  .PLTTBL     DC.L    STAEMPTY,STAEMPTY,STAEMPTY
000019E0                          1301  
000019E0                          1302  ; -----------------------------------------------------------------------------
000019E0                          1303  STAEMPTY
000019E0                          1304  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000019E0                          1305  ; INPUT    - NONE
000019E0                          1306  ; OUTPUT   - NONE
000019E0                          1307  ; MODIFIES - NONE
000019E0                          1308  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000019E0                          1309  ; -----------------------------------------------------------------------------
000019E0  4E75                    1310              RTS
000019E2                          1311  
000019E2                          1312  STATEGIN
000019E2                          1313              
000019E2  4EB8 1456               1314              JSR     RNDINIT
000019E6  4EB8 154A               1315              JSR     PLAYERINIT
000019EA  4EB8 16EE               1316              JSR     KEYINIT
000019EE  4EF8 177A               1317              JMP     STAIRSINIT
000019F2  4E75                    1318              RTS
000019F4                          1319  
000019F4                          1320  STATEGUP
000019F4  4EB8 155C               1321              JSR     PLAYERUPDT
000019F8  4EB8 1708               1322              JSR     KEYUPDT
000019FC  4EB8 1794               1323              JSR     STAIRSUPDT
00001A00  4EF8 14DE               1324              JMP     AGLUPDT
00001A04                          1325  
00001A04  4E75                    1326              RTS
00001A06                          1327  STATEGPL
00001A06  4EB8 1694               1328              JSR     MAPPLOT
00001A0A  4EB8 15EE               1329              JSR     PLAYERPLOT
00001A0E  4EB8 1732               1330              JSR     KEYPLOT
00001A12  4EB8 1820               1331              JSR     STAIRSPLOT
00001A16  4EB8 1920               1332              JSR     MISCPLOT
00001A1A  4EF8 1502               1333              JMP     AGLPLOT
00001A1E  4E75                    1334              RTS
00001A1E  4E75                    1335  -------------------- end include --------------------
00001A20                          1336              
00001A20                          1337  
00001A20                          1338  ; --- INITIALIZE --------------------------------------------------------------
00001A20                          1339  
00001A20                          1340  START                       ; INITIALIZE SYSTEM-RELATED STUFF
00001A20  4EB8 1000               1341              JSR     SYSINIT 
00001A24  4EB8 19E2               1342              JSR     STATEGIN
00001A28                          1343              
00001A28                          1344  ; --- UPDATE ------------------------------------------------------------------
00001A28                          1345  
00001A28  4E40                    1346  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001A2A                          1347  
00001A2A  4EB8 19F4               1348              JSR     STATEGUP
00001A2E                          1349              
00001A2E                          1350  ; --- WAIT SYNCH --------------------------------------------------------------
00001A2E                          1351  
00001A2E  4A39 00001A4A           1352  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001A34  67F8                    1353              BEQ     .WINT
00001A36  4239 00001A4A           1354              CLR.B   (SCRINTCT)
00001A3C                          1355  
00001A3C                          1356  ; --- PLOT --------------------------------------------------------------------
00001A3C                          1357  
00001A3C  4EB8 1A06               1358              JSR     STATEGPL
00001A40                          1359  
00001A40  4E41                    1360              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001A42  60E4                    1361              BRA     .LOOP                   ; MAIN LOOP
00001A44                          1362  
00001A44                          1363  ; --- DEATH -------------------------------------------------------------------
00001A44                          1364  LOOSE
00001A44  FFFF FFFF               1365              SIMHALT
00001A48                          1366  
00001A48                          1367  ; --- VARIABLES ---------------------------------------------------------------
00001A48                          1368  
00001A48                          1369              INCLUDE "SYSVAR.X68"
00001A48                          1370  ; =============================================================================
00001A48                          1371  ; TITLE    : SYSTEM VARIABLES
00001A48                          1372  ; AUTHOR   : ANTONI BURGUERA
00001A48                          1373  ; COMMENTS : NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO
00001A48                          1374  ;            USER. THUS THEY MUST NOT BE IN PROTECTED MEMORY.
00001A48                          1375  ;            NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER
00001A48                          1376  ;            APPLICATIONS CAN ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR
00001A48                          1377  ;            THE SAKE OF THIS EXAMPLE THIS IS GOOD ENOUGH.
00001A48                          1378  ; HISTORY  : XX-XXX-201X - CREATION
00001A48                          1379  ;            11-OCT-2020 - MINOR CHANGES
00001A48                          1380  ; =============================================================================
00001A48                          1381  
00001A48                          1382  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001A48                          1383  
00001A48                          1384  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001A49                          1385  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001A4A                          1386  
00001A4A                          1387              DS.W    0
00001A4A                          1388  
00001A4A                          1389  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001A4A                          1390  
00001A4A                          1391  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001A4B                          1392  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001A4C                          1393              DS.W    0
00001A4C                          1394  
00001A4C                          1395  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001A4C                          1396  
00001A80                          1397              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001A80                          1398  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002700                          1399              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002700                          1400  -------------------- end include --------------------
00002700                          1401              INCLUDE "VAR.X68"
00002700                          1402  ; =============================================================================
00002700                          1403  ; TITLE    : GAME VARIABLES
00002700                          1404  ; AUTHOR   :
00002700                          1405  ; HISTORY  :
00002700                          1406  ; =============================================================================
00002700                          1407  
00002700                          1408  
00002700                          1409  PLAYERX     DS.W    1   ; PLAYER X COORDINATE
00002702                          1410  PLAYERY     DS.W    1   ; PLAYER Y COORDINATE
00002704                          1411  
00002704                          1412  KEYX        DS.W    1   ; KEY X COORDINATE
00002706                          1413  KEYY        DS.W    1   ; KEY Y COORDINATE
00002708                          1414  
00002708                          1415  STAIRSX     DS.W    1   ; STAIRS X COORDINATE
0000270A                          1416  STAIRSY     DS.W    1   ; STAIRS Y COORDINATE
0000270C                          1417  
0000270C                          1418  STACUR      DS.W    1   ; CURRENT STATE
0000270E                          1419  STANEXT     DS.W    1   ; NEXT STATE 
00002710                          1420  
00002710= 0000                    1421  KEYOBTEINED DC.W    0   ; "BOOLEAN" VALUE, SELF EXPLANATORY 
00002712                          1422  
00002712                          1423  ; NOKEYTIMER  DS.W    1
00002712                          1424  
00002712                          1425  RNGXINDEX   DS.W    1   ; INDEX FOR THE X COORDINATE ON THE PSEUDO RANDOM GENERATOR
00002714                          1426  RNGYINDEX   DS.W    1   ; INDEX FOR THE Y COORDINATE ON THE PSEUDO RANDOM GENERATOR
00002716                          1427  
00002716= 0000                    1428  LEVEL       DC.W    0   ; LEVEL COUNTER
00002718                          1429  
00002718                          1430  
00002718                          1431  
00002718                          1432  
00002718                          1433  
00002718                          1434  
00002718                          1435  -------------------- end include --------------------
00002718                          1436              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14C4
AGLADD:END          14DA
AGLFKIL             1528
AGLFKIL:END         1544
AGLFKIL:LOOP        1530
AGLKILL             11C0
AGLPLOT             1502
AGLPLOT:END         1522
AGLPLOT:LOOP        150A
AGLUPDT             14DE
AGLUPDT:END         14FC
AGLUPDT:LOOP        14E6
DEATH               1636
DEATHSTRING         11F0
DMMALLOC            11A6
DMMALLOC:END        11BE
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1A80
DMMFCOM             1180
DMMFFND             118E
DMMFIRST            1136
DMMFLOOP            1174
DMMFRCOM            1148
DMMFREE             11C0
DMMFRFND            1156
DMMFRLOP            113C
DMMFRSTO            116E
DMMINIT             1114
DMMINIT:LOOP        1122
DMMNEXT             1158
DMMNEXTO            1190
DMMSYSID            0
EMPTYID             1
ENEMYID             7
ENEMYINIT           189E
ENEMYINIT:CHECKX    18A6
ENEMYINIT:CHECKY    18AC
ENEMYMAXCNT         C
ENEMYPLOT           18DA
ENEMYUPDT           18BA
ENEMYUPDT:END       18D4
FLOORID             3
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1A49
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             10B4
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10CA
KBDREAD:LOOP        110A
KBDREAD:STORE       1106
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1A48
KEYID               5
KEYINIT             16EE
KEYOBTEINED         2710
KEYPLOT             1732
KEYPLOT:NOKEY       1778
KEYUPDT             1708
KEYUPDT:END         172C
KEYX                2704
KEYY                2706
LEVEL               2716
LEVELSTRING         1250
LOOSE               1A44
MAPINIT             1690
MAPPLOT             1694
MAPUPDT             1692
MISCINIT            191C
MISCPLOT            1920
MISCPLOT:LVLPLOT    1928
MISCUPDT            191E
NOKEYSTRING         11D6
PLAYERINIT          154A
PLAYERPLOT          15EE
PLAYERUPDT          155C
PLAYERUPDT:MOVED    15D6
PLAYERUPDT:MOVEL    158E
PLAYERUPDT:MOVER    15A6
PLAYERUPDT:MOVEU    15BE
PLAYERUPDT:RMVED    15E4
PLAYERUPDT:RMVEL    159C
PLAYERUPDT:RMVER    15B4
PLAYERUPDT:RMVEU    15CC
PLAYERX             2700
PLAYERY             2702
PLYRID              6
RNDINIT             1456
RNGX                1464
RNGX:NOVERFLOW      1490
RNGXINDEX           2712
RNGY                1494
RNGY:NOVERFLOW      14C0
RNGYINDEX           2714
SCRCYCCT            1A4B
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1A4A
SCRIRQ              1
SCRISR              108C
SCRTIM              64
SCRTRAP             1
SCRUPD              109A
SCRWIDTH            280
STACUR              270C
STAEMPTY            19E0
STAINIT             1950
STAIRID             4
STAIRSINIT          177A
STAIRSPLOT          1820
STAIRSPLOT:END      1898
STAIRSPLOT:KEYOBTEINED  1872
STAIRSUPDT          1794
STAIRSUPDT:END      181A
STAIRSUPDT:ENEMYADD  17D0
STAIRSUPDT:NOKEY    1800
STAIRSX             2708
STAIRSY             270A
STANEXT             270E
STAPLOT             19B8
STAPLOT:PLTTBL      19D4
START               1A20
START:LOOP          1A28
START:WINT          1A2E
STATEGIN            19E2
STATEGPL            1A06
STATEGUP            19F4
STAUPD              1962
STAUPD:DOUPD        1988
STAUPD:INITBL       19A0
STAUPD:UPDTBL       19AC
SUSSERTOD           1214
SYSINIT             1000
TILEDARK            745B6D
TILEDETA            A38099
TILEDIM             20
TILELIGH            CCE0EA
UTILCOLL            143A
UTILCOLL:NOCOL      1454
UTILFILL            CD
UTILPEN             0
UTILTEXT            196
UTILTILE            2C0
WALLID              2
XVALUES             125A
YVALUES             1278
